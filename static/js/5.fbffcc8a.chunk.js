(this["webpackJsonpinsta-clone"]=this["webpackJsonpinsta-clone"]||[]).push([[5],{64:function(e,t,s){"use strict";var n=s(39),c=s(5),r=s.n(c),o=s(8),a=s(14),l=s(1),i=s(25),u=s(23),d=s(2);t.a=function(e){var t,s=e.docId,c=e.totalLikes,j=e.likedPhoto,m=e.handleFocus,b=Object(l.useContext)(i.a).user.uid,f=void 0===b?"":b,x=Object(l.useState)(j),O=Object(a.a)(x,2),h=O[0],p=O[1],w=Object(l.useState)(c),g=Object(a.a)(w,2),v=g[0],N=g[1],y=Object(l.useContext)(u.a),k=y.firebase,I=y.FieldValue,C=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!h),e.next=3,k.firestore().collection("photos").doc(s).update({likes:h?I.arrayRemove(f):I.arrayUnion(f)});case 3:N((function(e){return h?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"flex justify-between px-4 pt-2",children:Object(d.jsxs)("div",{className:"flex",children:[Object(d.jsx)("svg",{onClick:C,onKeyDown:function(e){"Enter"===e.key&&C()},xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-8 mr-4 select-none cursor-pointer ".concat(h?"fill-red text-red-600":"text-gray-800"),children:Object(d.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),Object(d.jsx)("svg",(t={onClick:m,onKeyDown:function(e){"Enter"===e.key&&m()},xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Object(n.a)(t,"className","w-8 mr-4 select-none text-gray-800 cursor-pointer"),Object(n.a)(t,"children",Object(d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})),t))]})}),Object(d.jsx)("div",{className:"px-4 py-0 my-0",children:Object(d.jsx)("p",{className:"font-semibold",children:"".concat(v,1===v?" like":" likes ")})})]})}},65:function(e,t,s){"use strict";s(1);var n=s(19),c=s(2);t.a=function(e){var t=e.caption,s=e.username;return Object(c.jsxs)("div",{className:"px-4 pt-0 pb-0",children:[Object(c.jsx)(n.b,{to:"/profile/".concat(s),children:Object(c.jsxs)("span",{className:"mr-1 font-medium text-gray-800",children:[s,":"]})}),Object(c.jsx)("span",{className:"text-xs text-gray-800",children:t})]})}},66:function(e,t,s){"use strict";var n=s(14),c=s(1),r=s(77),o=s(19),a=s(69),l=s(23),i=s(25),u=s(2);var d=function(e){var t=e.docId,s=e.comments,r=e.setComments,o=e.commentInput,d=Object(c.useState)(""),j=Object(n.a)(d,2),m=j[0],b=j[1],f=Object(c.useContext)(l.a),x=f.firebase,O=f.FieldValue,h=Object(c.useContext)(i.a).user.displayName,p=function(e){if(e.preventDefault(),m.length>0)return r([{displayName:h,comment:m}].concat(Object(a.a)(s))),b(""),x.firestore().collection("photos").doc(t).update({comments:O.arrayUnion({displayName:h,comment:m})})};return Object(u.jsx)("div",{className:"border-t border-gray-500",children:Object(u.jsxs)("form",{method:"POST",onSubmit:p,className:"flex justify-between px-0",children:[Object(u.jsx)("input",{"aria-label":"Add a Comment",autocomplete:"off",type:"text",name:"add-comment",value:m,placeholder:"Add a comment...",onChange:function(e){var t=e.target;return b(t.value)},ref:o,className:"text-sm text-gray-800 w-full mr-1 py-2 px-4"}),Object(u.jsx)("button",{className:"px-2 cursor-pointer  text-blue-500 ".concat(!m&&"opacity-25"," "),type:"button",disabled:m.length<1,onClick:p,children:Object(u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 rotate-90",viewBox:"0 0 20 20",fill:"blue",className:"w-6 transform rotate-90",children:Object(u.jsx)("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})};function j(e){var t=e.item;return Object(u.jsxs)("p",{className:"mb-0",children:[Object(u.jsx)(o.b,{to:"/profile/".concat(t.displayName),children:Object(u.jsxs)("span",{className:"mr-1 font-medium text-gray-800",children:[t.displayName,":"]})}),Object(u.jsx)("span",{className:"text-xs",children:t.comment})]})}t.a=function(e){var t=e.docId,s=e.comments,o=e.posted,a=e.commentInput,l=Object(c.useState)(s),i=Object(n.a)(l,2),m=i[0],b=i[1],f=Object(c.useState)(!1),x=Object(n.a)(f,2),O=x[0],h=x[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{className:"px-4 py-2",children:[m.length>=3&&Object(u.jsx)("p",{className:"text-sm text-gray-800 mb-0 cursor-pointer",onClick:function(){return h(!O)},children:O?"show less comments":"View all ".concat(m.length," comments")}),O?m.slice(0,10).map((function(e){return Object(u.jsx)(j,{item:e},"".concat(e.comment,"-").concat(e.displayName))})):m.slice(0,2).map((function(e){return Object(u.jsx)(j,{item:e},"".concat(e.comment,"-").concat(e.displayName))})),Object(u.jsxs)("p",{className:"text-gray-800 text-xs mt-1",children:[Object(r.a)(o,new Date)," ago"]})]}),Object(u.jsx)(d,{className:"bottom-0",docId:t,comments:m,setComments:b,commentInput:a})]})}},79:function(e,t,s){"use strict";s.r(t);var n=s(5),c=s.n(n),r=s(8),o=s(14),a=s(1),l=s.n(a),i=s(9),u=s(24),d=s(12),j=s(31),m=s(6),b=s(26),f=s.n(b),x=s(27),O=s(62),h=s.n(O),p=l.a.createContext({}),w=l.a.createContext({}),g=s(2);var v=function(e){var t=e.photosCount,s=e.followerCount,n=(e.followingCount,e.setFollowerCount),l=Object(x.a)().user,d=Object(a.useState)(!1),j=Object(o.a)(d,2),m=j[0],b=j[1],f=Object(a.useContext)(w),O=f.userr,v=f.dispatchFollowEvent,N=l.username&&l.username!==O.username,y=Object(i.g)(),k=Object(a.useContext)(p).dispatchUserEvent;Object(a.useEffect)((function(){var e=function(){var e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.j)(l.username,O.userId);case 2:t=e.sent,b(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();l.username&&O.userId&&e()}),[l.username,O.followers,O.following,O.userId]);var I=function(){var e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!m),e.next=3,Object(u.m)(l.docId,O.userId,m);case 3:return e.next=5,Object(u.l)(O.docId,l.userId,m);case 5:return e.next=7,Object(u.g)(O.userId);case 7:t=e.sent,v("UPDATE_FOLLOWER",t[0]),n({followerCount:m?s-1:s+1,profile:t});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{className:"md:grid md:grid-cols-3 md:gap-4 justify-between mx-4 md:mx-auto max-w-screen-lg mb-16 mt-16",children:[Object(g.jsx)("div",{className:"container relative md:flex justify-center",children:O.username&&Object(g.jsx)("img",{className:"rounded-full h-40 w-40 z-0",alt:"".concat(O.username," profile pic"),src:O.profilePicture?O.profilePicture:"/insta-clone/images/avatars/dali.jpg"})}),Object(g.jsxs)("div",{className:"flex items-center justify-center  flex-col col-span-2",children:[Object(g.jsxs)("div",{className:"container flex items-center mt-4",children:[Object(g.jsx)("p",{className:"text-2xl mr-4",children:O.username}),N?Object(g.jsx)("button",{type:"button",className:"bg-blue-600 font-bold text-sm rounded text-white w-20 h-8",onClick:I,children:m?"Unfollow":"Follow"}):Object(g.jsx)("button",{type:"button",className:"bg-gray-200 font-bold text-sm rounded text-gray-700 w-20 h-8",onClick:function(){y.push("/profile/edit/".concat(l.username))},children:"Edit Profile"})]}),Object(g.jsx)("div",{className:"container flex mt-4",children:void 0===O.followers||void 0===O.following?Object(g.jsx)(h.a,{count:1,width:677,height:24}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("p",{className:"mr-10",children:[Object(g.jsx)("span",{className:"font-bold",children:t}),"  ".concat(1===t?"post":"posts")]}),Object(g.jsxs)("p",{className:"mr-10 cursor-pointer",onClick:function(){k("SHOW_FOLLOWERS",O.followers)},children:[Object(g.jsx)("span",{className:"font-bold",children:O.followers.length}),"  ".concat(1===O.followers.length?"follower":"followers")]}),Object(g.jsxs)("p",{className:"mr-10 cursor-pointer",onClick:function(){k("SHOW_FOLLOWING",O.following)},children:[Object(g.jsx)("span",{className:"font-bold",children:O.following.length}),"  following"]})]})}),Object(g.jsx)("div",{className:"container mt-4",children:Object(g.jsx)("p",{className:"font-medium text-gray-700",children:O.fullName?O.fullName:Object(g.jsx)(h.a,{count:1,height:24})})}),Object(g.jsx)("div",{className:"container mt-1",children:Object(g.jsx)("p",{className:"text-gray-700",children:O.bio?O.bio:Object(g.jsx)(h.a,{count:1,height:48})})})]})]})};var N=function(e){var t=e.photos,s=(e.setSelectedImg,Object(a.useContext)(p)),n=(s.selectedImg,s.dispatchUserEvent);return Object(g.jsxs)("div",{className:"h-16 border-t border-gray-300 mt-12 pt-4",children:[Object(g.jsx)("div",{className:"grid grid-cols-3 gap-4 mt-4 mb-12 mx-4",children:t?t.length>0?t.map((function(e){return Object(g.jsxs)("div",{className:"relative group  h-28 sm:h-48 md:h-64",onClick:function(){return n("SHOW_PHOTO",e)},children:[Object(g.jsx)("img",{src:e.imageSrc,alt:e.caption,className:"object-cover w-full h-full"}),Object(g.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-full \r justify-evenly items-center bg-gray-500 bg-opacity-50 \r group-hover:flex hidden",children:Object(g.jsxs)("p",{className:"flex justify-between items-center text-white font-bold",children:[Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-8 mr-2",children:Object(g.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),e.likes.length,Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mr-5",viewBox:"0 0 20 20",fill:"currentColor",className:"w-8 h-8 ml-8 mr-2",children:Object(g.jsx)("path",{"fill-rule":"evenodd",d:"M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z","clip-rule":"evenodd"})}),e.comments.length]})})]},e.docId)})):null:Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(h.a,{count:12,width:320,height:400})})}),!t||0===t.length&&Object(g.jsx)("p",{className:"text-center text-2xl",children:"No Posts Yet"})]})},y=s(64),k=s(66),I=s(65),C=function(){var e=Object(a.useRef)(null),t=Object(a.useContext)(p),s=t.selectedImg,n=t.dispatchUserEvent;return Object(g.jsx)("div",{className:"fixed flex w-full h-full justify-center items-center inset-0 start-0 top-0 backdrop-filter backdrop-blur-sm",onClick:function(e){e.target.classList.contains("backdrop-filter")&&n("HIDE_PHOTO",{})},children:Object(g.jsxs)("div",{className:" pb-8 md:pb-0 overflow-y-auto md:fixed md:flex  justify-center max-h-full inset-y-2 max-w-2xl my-16 bg-gray-200 shadow-2xl rounded-md",children:[Object(g.jsx)("img",{src:s.imageSrc,alt:"enlarged image",className:" object-scale-down rounded-md flex-shrink-0"}),Object(g.jsxs)("div",{className:"pl-3 w-full overflow-y-auto",children:[Object(g.jsx)(y.a,{docId:s.docId,totalLikes:s.likes.length,likedPhoto:s.userLikedPhoto,handleFocus:function(){return e.current.focus()}}),Object(g.jsx)(I.a,{caption:s.caption,username:s.name}),Object(g.jsx)(k.a,{docId:s.docId,comments:s.comments,posted:s.dateCreated,commentInput:e})]}),Object(g.jsx)("div",{className:"absolute right-0 top-0 bg-gray-300",onClick:function(){return n("HIDE_PHOTO",{})},children:Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-9 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(g.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})})})]})})},L=s(19);var E=function(e){var t=e.profileDocId,s=e.username,n=e.suggestedUserPic,l=e.profileId,i=e.userId,d=e.loggedInUserDocId,j=e.isFollow,m=e.setProfile,b=Object(a.useState)(j),f=Object(o.a)(b,2),O=f[0],h=f[1],v=Object(a.useContext)(p),N=(v.followers,v.followings,v.dispatchUserEvent),y=Object(x.a)().user,k=Object(a.useContext)(w),I=(k.userr,k.dispatchFollowEvent);function C(){return(C=Object(r.a)(c.a.mark((function e(){var s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!O),e.next=3,Object(u.m)(d,l,O);case 3:return e.next=5,Object(u.l)(t,i,O);case 5:return e.next=7,Object(u.g)(i);case 7:s=e.sent,m({profile:s[0]}),I("UPDATE_FOLLOWER",s[0]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(g.jsxs)("div",{className:" h-full flex  items-center  align-items justify-between z-20 border-black",children:[Object(g.jsx)("div",{className:" justify-between mr-3 flex",onClick:function(e){N("HIDE_FOLLOWING",{}),N("HIDE_FOLLOWERS",{})},children:Object(g.jsxs)(L.b,{to:"/profile/".concat(s),className:" mr-3 flex items-center align-center",children:[Object(g.jsx)("img",{className:"rounded-full w-10 h-10 mr-3 ",src:n||"/insta-clone/images/avatars/dali.jpg",alt:"user profile pic"}),Object(g.jsx)("p",{className:"font-bold  text-sm flex",children:s})]})}),Object(g.jsx)("div",{children:Object(g.jsx)("button",{className:"text-xs font-bold text-blue-500",type:"button",onClick:function(){return C.apply(this,arguments)},children:t!==y.docId?O?"Unfollow":"Follow":null})})]})};var F=function(e){var t=e.isFollow,s=e.setProfile,n=Object(a.useState)(null),l=Object(o.a)(n,2),i=l[0],d=l[1],j=Object(a.useContext)(p),m=j.followers,b=j.followings,f=j.dispatchUserEvent,x=Object(a.useContext)(w).userr;return Object(a.useEffect)((function(){function e(){return(e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.c)(x.userId,m);case 2:t=e.sent,d(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function s(){return(s=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.d)(x.userId,b);case 2:t=e.sent,d(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t?function(){e.apply(this,arguments)}():function(){s.apply(this,arguments)}()}),[m,b,x.followers]),i?i.length>0?Object(g.jsx)("div",{className:"fixed flex w-full h-full justify-center items-center inset-0 start-0 top-0 backdrop-filter backdrop-blur-lg",onClick:function(e){e.target.classList.contains("backdrop-filter")&&(m&&f("HIDE_FOLLOWERS",{}),b&&f("HIDE_FOLLOWING",{}))},children:Object(g.jsxs)("div",{className:"w-full sm:w-2/5 md:w-3/12 rounded-md flex flex-col bg-gray-100 ",children:[Object(g.jsxs)("div",{className:" text-sm text-center grid-3 relative justify-end my-2 ",children:[Object(g.jsx)("p",{className:"font-bold text-gray-600 object-center",children:t?"Followers":"Following"}),Object(g.jsx)("div",{className:"absolute right-0 top-0 ",onClick:function(){return f("HIDE_FOLLOWERS",{}),f("HIDE_FOLLOWING",{})},children:Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(g.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})})})]}),Object(g.jsx)("div",{className:"flex flex-col gap-4 m-4",children:i.map((function(e){return Object(g.jsx)(E,{profileDocId:e.docId,username:e.username,suggestedUserPic:e.profilePicture,profileId:e.userId,userId:x.userId,loggedInUserDocId:x.docId,isFollow:x.following.includes(e.userId),setProfile:s},e.docId)}))})]})}):null:Object(g.jsx)(h.a,{count:1,height:150,className:"mt-5"})};v.propTypes={user:f.a.shape({dateCreated:f.a.number.isRequired,emailAddress:f.a.string.isRequired,followers:f.a.array.isRequired,following:f.a.array.isRequired,fullName:f.a.string.isRequired,username:f.a.string.isRequired,userId:f.a.string.isRequired}).isRequired};var S=function(){var e=Object(a.useContext)(w).userr,t=Object(a.useReducer)((function(e,t){return Object(m.a)(Object(m.a)({},e),t)}),{profile:{},photosCollection:[],followerCount:0}),s=Object(o.a)(t,2),n=s[0],l=(n.profile,n.photosCollection),i=n.followerCount,d=n.followingCount,j=s[1],b=Object(a.useState)(null),f=Object(o.a)(b,2),x=f[0],O=f[1],h=Object(a.useState)(null),y=Object(o.a)(h,2),k=y[0],I=y[1],L=Object(a.useState)(null),E=Object(o.a)(L,2),S=E[0],H=E[1];return Object(a.useEffect)((function(){function t(){return(t=Object(r.a)(c.a.mark((function t(){var s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.i)(e.userId);case 2:(s=t.sent).sort((function(e,t){return t.dateCreated-e.dateCreated})),j({profile:e,photosCollection:s,followerCount:e.followers.length,followingCount:e.following.length});case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,k,S]),Object(g.jsxs)(p.Provider,{value:{followers:k,followings:S,selectedImg:x,dispatchUserEvent:function(e,t){switch(e){case"SHOW_FOLLOWERS":return void I(t);case"HIDE_FOLLOWERS":return void I(null);case"SHOW_FOLLOWING":return void H(t);case"HIDE_FOLLOWING":return void H(null);case"SHOW_PHOTO":return void O(t);case"HIDE_PHOTO":return void O(null);default:return}}},children:[Object(g.jsx)(v,{photosCount:l?l.length:0,followerCount:i,followingCount:d,setFollowerCount:j}),Object(g.jsx)(N,{photos:l}),x&&Object(g.jsx)(C,{}),k&&Object(g.jsx)(F,{isFollow:!0,setProfile:j}),S&&Object(g.jsx)(F,{isFollow:!1,setProfile:j})]})};t.default=function(){var e=Object(i.h)().username,t=Object(a.useState)(null),s=Object(o.a)(t,2),n=s[0],l=s[1],m=Object(i.g)();return Object(a.useEffect)((function(){function t(){return(t=Object(r.a)(c.a.mark((function t(){var s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.h)(e);case 2:(s=t.sent).length>0?(l(s[0]),document.title="".concat(s[0].fullName," (@").concat(e,")")):m.push(d.d);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,m]),(null===n||void 0===n?void 0:n.username)?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(j.a,{}),Object(g.jsx)(w.Provider,{value:{userr:n,dispatchFollowEvent:function(e,t){switch(e){case"UPDATE_FOLLOWER":return void l(t);default:return}}},children:Object(g.jsx)("div",{className:" mx-auto max-w-screen-lg",children:Object(g.jsx)("div",{className:"mx-auto mx-w-screen-lg",children:Object(g.jsx)(S,{})})})})]}):null}}}]);
//# sourceMappingURL=5.fbffcc8a.chunk.js.map