(this["webpackJsonpinsta-clone"]=this["webpackJsonpinsta-clone"]||[]).push([[5],{73:function(e,t,c){"use strict";c.r(t);var s=c(2),n=c(29),r=c(26),a=c(5),o=c.n(a),l=c(9),i=c(14),d=c(60),u=c.n(d),j=c(23),m=c(19),b=c(1);var x=function(e){var t=e.profileDocId,c=e.username,n=e.profilePic,r=e.profileId,a=e.userId,d=e.loggedInUserDocId,u=Object(s.useState)(!1),x=Object(i.a)(u,2),f=x[0],p=x[1];function h(){return(h=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,Object(j.k)(d,r,!1);case 3:return e.next=5,Object(j.j)(t,a,!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return f?null:Object(b.jsxs)("div",{className:"flex flex-row items-center align-items justify-between",children:[Object(b.jsxs)("div",{className:"flex items-center justify-between",children:[Object(b.jsx)("img",{className:"rounded-full w-8 flex mr-3",src:n||"/images/avatars/dali.jpg",alt:"user profile pic"}),Object(b.jsx)(m.b,{to:"/profile/".concat(c),children:Object(b.jsx)("p",{className:"font-bold text-sm",children:c})})]}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"text-xs font-bold text-blue-500",type:"button",onClick:function(){return h.apply(this,arguments)},children:"Follow"})})]})};var f=function(e){var t=e.userId,c=e.following,n=e.loggedInUserDocId,r=Object(s.useState)(null),a=Object(i.a)(r,2),d=a[0],m=a[1];return Object(s.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.d)(t,c);case 2:s=e.sent,m(s);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&function(){e.apply(this,arguments)}()}),[t]),d?d.length>0?Object(b.jsxs)("div",{className:"rounded flex flex-col ",children:[Object(b.jsx)("div",{className:"flex text-sm items-center align-items justify-between mb-2",children:Object(b.jsx)("p",{className:"font-bold text-gray-500",children:"Suggestions for you"})}),Object(b.jsx)("div",{className:"mt-4 grid gap-5",children:d.map((function(e){return Object(b.jsx)(x,{profileDocId:e.docId,username:e.username,suggestedUserPic:e.profilePic,profileId:e.userId,userId:t,loggedInUserDocId:n},e.docId)}))})]}):null:Object(b.jsx)(u.a,{count:1,height:150,className:"mt-5"})},p=c(37),h=c(25),O=c.n(h),g=function(e){var t=e.username,c=e.fullName,s=e.userProfilePic;return t&&c?Object(b.jsxs)(m.b,{to:"/profile/".concat(t),className:"grid grid-cols-4 gap-4 mb-6 items-center ",children:[Object(b.jsx)("div",{className:"flex items-center justify-between col-span-1 w-12 h-12   mr-3 ",children:Object(b.jsx)("img",{src:s,alt:"profile pic",className:"rounded-full w-12 h-12"})}),Object(b.jsxs)("div",{className:"col-span-3",children:[Object(b.jsx)("p",{className:"font-bold text-sm",children:t}),Object(b.jsx)("p",{className:"text-sm",children:c})]})]}):Object(b.jsx)(u.a,{count:1,height:61})};g.prototype=Object(p.a)({username:O.a.string.isRequired,fullName:O.a.string.isRequired},"fullName",O.a.string.isRequired);var v=g;var w=function(){var e=Object(r.a)().user;return Object(b.jsxs)("div",{className:"p-4 pt-0",children:[Object(b.jsx)("button",{}),Object(b.jsx)(v,{username:e&&e.username,fullName:e&&e.fullName,userProfilePic:e.profilePicture?e.profilePicture:"/images/avatars/dali.jpg"}),Object(b.jsx)(f,{userId:e&&e.userId,following:e&&e.following,loggedInUserDocId:e&&e.docId})]})},N=c(24);var y=function(){var e=Object(s.useState)(null),t=Object(i.a)(e,2),c=t[0],n=t[1],r=Object(s.useContext)(N.a).user.uid,a=void 0===r?"":r;return Object(s.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var t,c,s,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.e)(a);case 2:if((t=e.sent)&&(s=Object(i.a)(t,1),c=s[0].following),r=[],!(c.length>0)){e.next=9;break}return e.next=8,Object(j.c)(a,c);case 8:r=e.sent;case 9:r.sort((function(e,t){return t.dateCreated-e.dateCreated})),n(r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a]),{photos:c}},I=c(40);var k=function(e){var t=e.username,c=e.profilePic;return Object(b.jsx)("div",{className:"flex border-b border-gray-500 h-3 p-3 py-7",children:Object(b.jsx)("div",{className:"flex items-center",children:Object(b.jsxs)(m.b,{to:"/profile/".concat(t),className:"flex items-center",children:[Object(b.jsx)("div",{className:"rounded-full bg-gradient-to-t from-red-400 to-pink-800 \r h-10 w-10 content-center flex flex-wrap mr-3",children:Object(b.jsx)("div",{className:"rounded-full bg-white h-9 w-9 m-auto flex flex-wrap content-center items-center",children:Object(b.jsx)("img",{src:c,className:"rounded-full h-8 w-8 m-auto",alt:"".concat(t," profile pic")})})}),Object(b.jsx)("p",{className:"font-bold",children:t})]})})})};var C=function(e){var t=e.src,c=e.caption;return Object(b.jsx)("img",{src:t,alt:c})},P=c(22);var S=function(e){var t,c=e.docId,n=e.totalLikes,r=e.likedPhoto,a=e.handleFocus,d=Object(s.useContext)(N.a).user.uid,u=void 0===d?"":d,j=Object(s.useState)(r),m=Object(i.a)(j,2),x=m[0],f=m[1],h=Object(s.useState)(n),O=Object(i.a)(h,2),g=O[0],v=O[1],w=Object(s.useContext)(P.a),y=w.firebase,I=w.FieldValue,k=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!x),e.next=3,y.firestore().collection("photos").doc(c).update({likes:x?I.arrayRemove(u):I.arrayUnion(u)});case 3:v((function(e){return x?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"flex justify-between px-4 pt-2",children:Object(b.jsxs)("div",{className:"flex",children:[Object(b.jsx)("svg",{onClick:k,onKeyDown:function(e){"Enter"===e.key&&k()},xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-8 mr-4 select-none cursor-pointer ".concat(x?"fill-red text-red-600":"text-gray-800"),children:Object(b.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),Object(b.jsx)("svg",(t={onClick:a,onKeyDown:function(e){"Enter"===e.key&&a()},xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Object(p.a)(t,"className","w-8 mr-4 select-none text-gray-800 cursor-pointer"),Object(p.a)(t,"children",Object(b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})),t))]})}),Object(b.jsx)("div",{className:"px-4 py-0 my-0",children:Object(b.jsx)("p",{className:"font-semibold",children:"".concat(g,1===g?" like":" likes ")})})]})};var D=function(e){var t=e.caption,c=e.username;return Object(b.jsxs)("div",{className:"px-4 pt-0 pb-0",children:[Object(b.jsx)(m.b,{to:"/profile/".concat(c),children:Object(b.jsxs)("span",{className:"mr-1 font-medium text-gray-800",children:[c,":"]})}),Object(b.jsx)("span",{className:"text-xs text-gray-800",children:t})]})},F=c(72),L=c(67);var M=function(e){var t=e.docId,c=e.comments,n=e.setComments,r=e.commentInput,a=Object(s.useState)(""),o=Object(i.a)(a,2),l=o[0],d=o[1],u=Object(s.useContext)(P.a),j=u.firebase,m=u.FieldValue,x=Object(s.useContext)(N.a).user.displayName,f=function(e){if(e.preventDefault(),l.length>0)return n([{displayName:x,comment:l}].concat(Object(L.a)(c))),d(""),j.firestore().collection("photos").doc(t).update({comments:m.arrayUnion({displayName:x,comment:l})})};return Object(b.jsx)("div",{className:"border-t border-gray-500",children:Object(b.jsxs)("form",{method:"POST",onSubmit:f,className:"flex justify-between px-0",children:[Object(b.jsx)("input",{"aria-label":"Add a Comment",autocomplete:"off",type:"text",name:"add-comment",value:l,placeholder:"Add a comment...",onChange:function(e){var t=e.target;return d(t.value)},ref:r,className:"text-sm text-gray-800 w-full mr-1 py-2 px-4"}),Object(b.jsx)("button",{className:"px-2 cursor-pointer  text-blue-500 ".concat(!l&&"opacity-25"," "),type:"button",disabled:l.length<1,onClick:f,children:Object(b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 rotate-90",viewBox:"0 0 20 20",fill:"currentColor",className:"w-6 transform rotate-90",children:Object(b.jsx)("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})};function U(e){var t=e.item;return Object(b.jsxs)("p",{className:"mb-0",children:[Object(b.jsx)(m.b,{to:"/profile/".concat(t.displayName),children:Object(b.jsxs)("span",{className:"mr-1 font-medium text-gray-800",children:[t.displayName,":"]})}),Object(b.jsx)("span",{className:"text-xs",children:t.comment})]})}var V=function(e){var t=e.docId,c=e.comments,n=e.posted,r=e.commentInput,a=Object(s.useState)(c),o=Object(i.a)(a,2),l=o[0],d=o[1],u=Object(s.useState)(!1),j=Object(i.a)(u,2),m=j[0],x=j[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"px-4 py-2",children:[l.length>=3&&Object(b.jsx)("p",{className:"text-sm text-gray-800 mb-0 cursor-pointer",onClick:function(){return x(!m)},children:m?"show less comments":"View all ".concat(l.length," comments")}),m?l.slice(0,10).map((function(e){return Object(b.jsx)(U,{item:e},"".concat(e.comment,"-").concat(e.displayName))})):l.slice(0,2).map((function(e){return Object(b.jsx)(U,{item:e},"".concat(e.comment,"-").concat(e.displayName))})),Object(b.jsxs)("p",{className:"text-gray-800 text-xs mt-1",children:[Object(F.a)(n,new Date)," ago"]})]}),Object(b.jsx)(M,{docId:t,comments:l,setComments:d,commentInput:r})]})};var z=function(e){var t=e.content,c=Object(s.useRef)(null);return Object(b.jsxs)("div",{className:"rounded col-span-4 border bg-white border-gray-500 mb-8",children:[console.log("post profile",t.profilePicture),Object(b.jsx)(k,{username:t.username,profilePic:t.profilePicture?t.profilePicture:"/images/avatars/dali.jpg"}),Object(b.jsx)(C,{src:t.imageSrc,caption:t.caption}),Object(b.jsx)(S,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:function(){return c.current.focus()}}),Object(b.jsx)(D,{caption:t.caption,username:t.username}),Object(b.jsx)(V,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:c})]})};var A=function(){var e=y().photos,t=Object(r.a)().user;return Object(b.jsxs)("div",{className:"container col-span-2",children:[Object(b.jsxs)("div",{className:" flex items-center px-4 mx-2 mb-4",children:[Object(b.jsx)("div",{className:" flex flex-col h-0 w-2/5 border border-gray-500"}),Object(b.jsx)("div",{className:" flex flex-col items-center w-1/5 py-2",children:Object(b.jsx)("label",{for:"file-upload",children:Object(b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-14 w-14",viewBox:"0 0 20 20",fill:"currentColor",children:Object(b.jsx)("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})})})}),Object(b.jsx)("div",{className:" flex flex-col h-0 w-2/5 border border-gray-500"})]}),Object(b.jsx)("input",{type:"file",id:"file-upload",hidden:!0,accept:".jpeg, .png, .jpg",onChange:function(e){Object(I.a)(e.target.files[0]).then((function(e){Object(j.i)(t,e),console.log("result",e)})).catch((function(e){console.log(e)}))}}),e?e.length>0?e.map((function(e){return Object(b.jsx)(z,{content:e},e.docId)})):Object(b.jsx)("p",{className:"text-center text-2xl",children:"Follow pages to see photos"}):Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(u.a,{count:1,width:640,height:400,className:"mb-5"})})]})};t.default=function(){return Object(s.useEffect)((function(){document.title="Insta"}),[]),Object(b.jsxs)("div",{className:"bg-gray-100",children:[Object(b.jsx)(n.a,{}),Object(b.jsxs)("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg mt-16",children:[Object(b.jsx)(A,{}),Object(b.jsx)(w,{})]})]})}}}]);
//# sourceMappingURL=5.d4f69cc6.chunk.js.map